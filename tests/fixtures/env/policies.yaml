policies:
  container-limits:
    enabled: false
    cpu: '2'
    memory: 2Gi
  banned-image-tags:
    enabled: false
    tags:
      - latest
      # - master
  psp-host-filesystem:
    enabled: true
    allowedHostPaths:
      - pathPrefix: /tmp/
        readOnly: false
  psp-allowed-users:
    enabled: true
    runAsUser:
      rule: MustRunAsNonRoot
    runAsGroup:
      rule: MayRunAs
      ranges:
        - min: 1
          max: 65535
    supplementalGroups:
      rule: MayRunAs
      ranges:
        - min: 1
          max: 65535
    fsGroup:
      rule: MayRunAs
      ranges:
        - min: 1
          max: 65535
  psp-host-security:
    enabled: true
  psp-host-networking-ports:
    enabled: true
  psp-privileged:
    enabled: true
  psp-capabilities:
    enabled: true
    # requiredDropCapabilities:
    #     - ALL
    allowedCapabilities:
      - NET_BIND_SERVICE
      - NET_RAW
  psp-forbidden-sysctls:
    enabled: true
    forbiddenSysctls:
      - kernel.*
      - net.*
      - abi.*
      - fs.*
      - sunrpc.*
      - user.*
      - vm.*
  psp-apparmor:
    enabled: true
    allowedProfiles:
      - runtime/default
      # - docker/default
      # - unconfined
      # - localhost/<profile-name>
  psp-selinux:
    enabled: false
    seLinuxContext: RunAsAny
  psp-seccomp:
    enabled: false
    allowedProfiles:
      - runtime/default
      # - docker/default
      # - unconfined
      # - localhost/<profile-name>
  psp-allowed-repos:
    enabled: false
    repos:
      - harbor.demo.gke.otomi.cloud
      - harbor.demo.aks.otomi.cloud
      - harbor.demo.eks.otomi.cloud
