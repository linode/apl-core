bases:
  - snippets/defaults.yaml
---
bases:
  - snippets/env.gotmpl
---
bases:
  - snippets/derived.gotmpl
---
{{ readFile "snippets/templates.gotmpl" }}
{{- $v := .Values }}
{{- $a := $v.apps }}

releases:
  - name: linode-cfw
    installed: {{ $a | get "linode-cfw.enabled" }}
    namespace: kube-system
    <<: *default
  - name: kyverno
    installed: {{ $a | get "kyverno.enabled" }}
    namespace: kyverno
    <<: *default
  - name: kyverno-artifacts
    installed: {{ $a | get "kyverno.enabled" }}
    namespace: kyverno
    labels:
      pkg: kyverno
    <<: *raw
  - name: policy-reporter
    installed: {{ $a | get "policy-reporter.enabled" }}
    namespace: policy-reporter
    <<: *default
  - name: sealed-secrets
    installed: {{ $a | get "sealed-secrets.enabled" }}
    namespace: sealed-secrets
    <<: *default
  - name: cert-manager
    installed: true
    namespace: cert-manager
    labels:
      pkg: cert-manager
      app: core
    <<: *default
  - name: external-dns-artifacts
    installed: {{ $a | get "external-dns.enabled" }}
    namespace: external-dns
    <<: *raw
