{{- $v := .Values }}
{{- $i := $v.apps.istio }}

name: istio-ingressgateway{{- if $i.canaryRevision }}-{{ $i.canaryRevision }}{{ end }}-public
revision: {{ $i.canaryRevision | quote }}

{{- with .Values.otomi | get "globalPullSecret" nil }}
imagePullSecrets:
  - name: otomi-pullsecret-global
{{- end }}

labels:
  istio: ingressgateway{{- if $i.canaryRevision }}-{{ $i.canaryRevision }}{{ end }}-public
  app: ingressgateway

service:
  type: ClusterIP

resources: {{- $i.resources.ingressgateway | toYaml | nindent 2 }}
autoscaling:
  minReplicas: {{ $i | get "autoscaling.ingressgateway.minReplicas" }}
  maxReplicas: {{ $i | get "autoscaling.ingressgateway.maxReplicas" }}

priorityClassName: otomi-critical
