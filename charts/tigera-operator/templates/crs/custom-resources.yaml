{{- $installSpec := .Values.installation }}
{{- $secrets := list }}
{{- range $name := keys .Values.imagePullSecrets -}}
{{- $item := dict "name" $name }}
{{- $secrets = append $secrets $item }}
{{- end }}
{{- $_ := set $installSpec "imagePullSecrets" $secrets }}
apiVersion: operator.tigera.io/v1
kind: Installation
metadata:
  name: default
spec:
{{- $installSpec | toYaml | nindent 2 }}
{{- if .Values.apiServer.enabled }}
---
apiVersion: operator.tigera.io/v1
kind: APIServer
metadata:
  name: default
spec: {}
{{- end }}
