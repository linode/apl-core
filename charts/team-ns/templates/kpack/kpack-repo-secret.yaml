{{- $v := .Values }}
{{- $g := $v.apps.gitea }}
{{- range $v.builds }}
{{- if eq .source.type "otomi-gitea" }}
apiVersion: v1
kind: Secret
metadata:
  name: gitea-user-credentials-{{ .name }}
  annotations:
    kpack.io/git: harbor.{{ $v.cluster.domainSuffix }}
type: kubernetes.io/basic-auth
stringData:
  password: {{ $g.adminPassword }}
  username: {{ $g.adminUsername }}
{{- end }}
---
{{- if eq .source.type "git" }}
{{- if not .source.git.public }}
apiVersion: v1
kind: Secret
metadata:
  name: git-user-credentials-{{ .name }}
  annotations:
    kpack.io/git: {{ .repoUrl }}
type: kubernetes.io/basic-auth
stringData:
  username: {{ .source.git.repoUserName }}
  password: {{ .source.git.repoPassword }}
{{- end }}
{{- end }}
{{- end }}